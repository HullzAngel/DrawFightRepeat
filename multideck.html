<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Multi-Deck Card Draw</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background: #1c1c1c;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      overflow: hidden;
    }

    .game-container {
      display: grid;
      grid-template-columns: 200px 1fr 200px;
      grid-template-rows: 1fr;
      width: 100%;
      height: 100vh;
    }

    .deck-column {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 30px;
      padding: 20px;
    }

    .play-area {
    position: relative; /* important for absolute positioning of cards */
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    align-items: center;
    gap: 20px;
    padding: 20px;
    overflow-y: auto;
    }
    .card {
      width: 150px;
      height: 220px;
      perspective: 1000px;
      cursor: pointer;
      position: relative;
    }

    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      backface-visibility: hidden;
      background-size: cover;
      background-position: center;
      box-shadow: 0 8px 15px rgba(0,0,0,0.4);
      transition: transform 0.6s;
    }

    .card-front {
      transform: rotateY(0deg);
    }

    .card-back {
      transform: rotateY(180deg);
      display: flex;
      justify-content: center;
      align-items: flex-end;
      padding: 10px;
      box-sizing: border-box;
      text-shadow: 1px 1px 2px #000;
    }

    .card.flipped .card-front {
      transform: rotateY(180deg);
    }

    .card.flipped .card-back {
      transform: rotateY(360deg);
    }

    .card-text {
      background: rgba(0,0,0,0.6);
      color: #fff;
      font-size: 0.9rem;
      padding: 4px 8px;
      border-radius: 6px;
      margin-bottom: 10px;
    }

    button.deck-btn {
      width: 120px;
      height: 170px;
      border: none;
      border-radius: 12px;
      background-size: cover;
      background-position: center;
      cursor: pointer;
      box-shadow: 0 6px 12px rgba(0,0,0,0.5);
      transition: transform 0.2s;
    }

    button.deck-btn:hover {
      transform: scale(1.05);
    }

    .controls {
      position: absolute;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
    }

    .controls button {
      font-size: 1rem;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      background: #f5c242;
      color: #000;
      cursor: pointer;
    }

    .controls button:hover {
      background: #fff;
      color: #f5c242;
    }
  </style>
</head>
<body>
  <div class="game-container">
    <!-- Left Column -->
    <div class="deck-column">
      <button class="deck-btn" style="background-image:url('multideckImages/monster_back.png')" onclick="drawCard('monster', this)"></button>
      <button class="deck-btn" style="background-image:url('multideckImages/location_back.png')" onclick="drawCard('location', this)"></button>
      <button class="deck-btn" style="background-image:url('multideckImages/blessing_back.png')" onclick="drawCard('blessing', this)"></button>
    </div>

    <!-- Play Area -->
    <div class="play-area" id="playArea"></div>

    <!-- Right Column -->
    <div class="deck-column">
      <button class="deck-btn" style="background-image:url('multideckImages/curse_back.png')" onclick="drawCard('curse', this)"></button>
      <button class="deck-btn" style="background-image:url('multideckImages/item_back.png')" onclick="drawCard('item', this)"></button>
      <button class="deck-btn" style="background-image:url('multideckImages/money_back.png')" onclick="drawCard('money', this)"></button>
    </div>
  </div>

  <!-- Controls -->
  <div class="controls">
    <button onclick="reshuffle()">Reshuffle</button>
  </div>

  <script>
    const playArea = document.getElementById("playArea");

    const decks = {
      monster: {
        back: "multideckImages/monster_back.png",
        cards: [
          { text: "Black Dragon", img: "multideckImages/monsters/kbd.png" },
          { text: "General Graardor", img: "multideckImages/monsters/graar.png" },
          { text: "Zulrah", img: "multideckImages/monsters/zulrah.png" }
        ]
      },
      location: {
        back: "multideckImages/location_back.png",
        cards: [
          { text: "Falador", img: "multideckImages/locations/falador.png" },
          { text: "Varrock", img: "multideckImages/locations/kandarin.png" },
          { text: "Lumbridge", img: "multideckImages/locations/lumbridge.png" },
          { text: "Morytania", img: "multideckImages/locations/morytania.png" },
        ]
      },
      blessing: {
        back: "multideckImages/blessing_back.png",
        cards: [
          { text: "Double Loot", img: "images/blessing/divine_light.png" },
          { text: "Prayer Potions", img: "images/blessing/gold_gift.png" }
        ]
      },
      curse: {
        back: "multideckImages/curse_back.png",
        cards: [
          { text: "Lose Item", img: "images/curse/chains.png" },
          { text: "No Teleport", img: "images/curse/shadow.png" }
        ]
      },
      item: {
        back: "multideckImages/item_back.png",
        cards: [
          { text: "Ancient Godsword", img: "images/item/sword.png" },
          { text: "Dragon Claws", img: "images/item/potion.png" }
        ]
      },
      money: {
        back: "multideckImages/money_back.png",
        cards: [
          { text: "50k", img: "images/money/coin_pouch.png" },
          { text: "200k", img: "images/money/treasure_chest.png" }
        ]
      }
    };

    function createCard(deckName) {
      const deck = decks[deckName];
      const cardData = deck.cards[Math.floor(Math.random() * deck.cards.length)];

      const cardEl = document.createElement("div");
      cardEl.className = "card";

      // FRONT
      const front = document.createElement("div");
      front.className = "card-face card-front";
      front.style.backgroundImage = `url('${deck.back}')`;

      // BACK
      const back = document.createElement("div");
      back.className = "card-face card-back";
      back.style.backgroundImage = `url('${cardData.img}')`;

      const text = document.createElement("div");
      text.className = "card-text";
      text.textContent = cardData.text;
      back.appendChild(text);

      cardEl.appendChild(front);
      cardEl.appendChild(back);

      // Flip handler
      cardEl.addEventListener("click", () => {
        cardEl.classList.toggle("flipped");
      });

      return cardEl;
    }

    function drawCard(deckName, deckButton) {
        const card = createCard(deckName);
        playArea.appendChild(card);

        // Ensure play-area is relative, card is absolute
        card.style.position = "absolute";

        // Get positions relative to playArea
        const deckRect = deckButton.getBoundingClientRect();
        const playRect = playArea.getBoundingClientRect();

        // Start at deck button
        card.style.left = `${deckRect.left - playRect.left}px`;
        card.style.top = `${deckRect.top - playRect.top}px`;

        // Force reflow for transition
        card.getBoundingClientRect();

        // Animate to center of play area
        const centerX = playArea.clientWidth / 2 - card.offsetWidth / 2;
        const centerY = playArea.clientHeight / 2 - card.offsetHeight / 2;

        card.style.transition = "all 0.6s ease";
        card.style.left = `${centerX}px`;
        card.style.top = `${centerY}px`;

        // Once animation finishes, make card relative so flex layout works for multiple cards
        card.addEventListener("transitionend", () => {
            card.style.position = "relative";
            card.style.left = "0";
            card.style.top = "0";
            card.style.transition = "";
            // re-append so flex-wrap works
            playArea.appendChild(card);
        }, { once: true });
        }


    function reshuffle() {
      playArea.innerHTML = "";
    }
  </script>
</body>
</html>
